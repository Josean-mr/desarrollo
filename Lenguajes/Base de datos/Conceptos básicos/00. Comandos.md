# Entorno de desarrollo
## [[Docker]]
[[01. DOCKER]]
### Descarga de imagen
[Docker hub](https://hub.docker.com/_/mysql)
- docker run --name *some-mysql* -e MYSQL_ROOT_PASSWORD=*my-secret-pw* -d mysql:*tag*
	- `docker run --name mysql-server -e MYSQL_ROOT_PASSWORD=4Sasd2D -d mysql:8.0.38`
### Inspeccionar contenedor
- docker inspect *id_contenedor*
	- `docker inspect 94e93`
# Iniciar sesión
El primer usuario creado por defecto es root.
- **En local** 
	- mysql -u *nombre_usuario* -p
- **En remoto (sin puerto)**
	- mysql -u *nombre_usuario* -p -h *ip_servidor nombre_base_datos*
		- `mysql -u admin -p -h 172.17.0.2 inventario`
- **En remoto (con puerto)**
	- mysql -u *nombre_usuario* -p -h *ip_servidor* *nombre_base_datos* -P *puerto*
		- `mysql -u admin -p -h 172.17.0.2 inventario -P 3306`
# Importar fichero a base de datos
source /ruta_origen/fichero.sql
# Juego carácteres y Collations  
[[02. Juego de caracteres, Collations]]
- Consultar el **juego de caracteres predefenido**:
	```sql
	SHOW VARIABLES LIKE 'char%';
	```
![[Pasted image 20240813181718.png]]
- Consultar el Collation por defecto:
	```sql
	SHOW VARIABLES LIKE 'coll%';
	```
![[Pasted image 20240813182023.png]]
# Comprobar lista de motores de almacenamiento disponibles
[[03. Comprobar lista de motores disponibles]]
```sql
SHOW ENGINES;
```
# Usuarios
[[04. Usuarios]]
### Lista de usuarios
```sql
SELECT User FROM mysql.user;
```
## Crear usuario
- Se debe tener permisos de administrador:
	```sql
	CREATE USER 'nombre_usuario'@'%' IDENTIFIED BY 'contraseña';
	```
	- <font style="color:green">Ejemplo</font>:
		```sql
		CREATE USER 'admin_db'@'%' IDENTIFIED BY 'as212Ds';
		```
		- % indica que el usuario puede conectarse desde cualquier host. Se puede sustituir por una dirección IP o nombre de host válido.
## Permisos a usuario
[Link](https://codigofacilito.com/articulos/asignar-permisos-mysql)
#### Listado de permisos:
- _CREATE_ permite crear nuevas tablas o bases de datos.
- _DROP_ permite eliminar tablas o bases de datos.
- _DELETE_ permite eliminar registros de tablas.
- _INSERT_ permite insertar registros en tablas.
- _SELECT_ permite leer registros en las tablas.
- _UPDATE_ permite actualizar registros en las tablas.
- _GRANT OPTION_ permite remover permisos de usuarios.
- SHOW DATABASE Permite listar las bases de datos existentes.
### Dar permisos a usuario (GRANT)
- Todos los permisos a un usuario:
	```sql
	GRANT ALL PRIVILEGES ON *.* TO 'nombre_usuario'@'%';
	```
- Asignar permiso para actualizar registros en tabla coches desde el sistema que contiene la base de datos (localhost):
	```SQL
	GRANT UPDATE ON coches TO 'nombre_usuario'@'localhost';
	```
### Eliminar permisos (REVOKE)
- Sustituir la palabra reservada GRANT por REVOKE y to por FROM:
	```SQL
	REVOKE UPDATE ON  coches FROM 'nombre_usuario'@'localhost';
	```
### Consultar permisos de usuario
```SQL
SHOW GRANTS FOR 'admin_user'@'localhost';
```
### Eliminar usuario
``` SQL
DROP USER 'nombre_usuario'@'localhost';
```
# Base de datos
### Creación de base de datos
- <font style="color:#08F; font-weight:bold">CREATE DATABASE</font>
	- <font style="color:green">Ejemplo</font>:
		```SQL
		CREATE DATABASE Concesionario;
		```
### Eliminación de base de datos
- <font style="color:#08F; font-weight:bold">DROP DATABASE</font>
	- <font style="color:green">Ejemplo</font>:
		```SQL
		DROP DATABASE Concesionario
		```
### Ver bases de datos existentes
``` sql
SHOW DATABASES;
```
### Entrar en una base de datos
- <font style="color:#08F; font-weight:bold">USE</font>
	- <font style="color:green">Ejemplo</font>:
	```SQL
	USE nombre_base_de_datos;
	```
# Tablas y columnas
[[06. Tablas y columnas]]
## Tablas
### Crear tabla
 - <font style="color:orange; font-weight:bold">Sintaxis</font>:
	```sql
	CREATE TABLE nombre_tabla;
	```
	- El usuario que crea la tabla se convierte en propietario.
### Eliminar tabla
- <font style="color:orange; font-weight:bold">Sintaxis</font>:
	```sql
	DROP TABLE nombre_tabla;
	```
## Columnas
- <font style="color:#08F; font-weight:bold">Definir columnas durante la creación de una tabla</font>:
	- <font style="color:orange; font-weight:bold">Sintaxis</font>:
		```SQL
		 CREATE TABLE nombre_tabla (
			nombrecolumna     TIPO_COLUMNA [restricciones]
			[,nombrecolumna ......]
			[,restricciones])
		```
		Las **restricciones** establecen reglas de integridad:
		- UNIQUE
		- REFERENCES
		- NULL
		- DEFAULT
		- ...
	- <font style="color:green">Ejemplo</font>:
		```SQL
		CREATE TABLE DEPARTAMENTOS (
			COD INTEGER PRIMARY KEY,
			NOMBRE VARCHAR(45) NOT NULL,
			DIR VARCHAR(45),
			CIUDAD VARCHAR(45),
			TLF VARCHAR(9)
			);
		```
- <font style="color:#08F; font-weight:bold">Agregar columna a tabla ya creada</font>:
	- <font style="color:orange; font-weight:bold">Sintaxis</font>:
		```SQL
		 ALTER TABLE nombre_tabla
		 ADD COLUMN nombre_columna tipo_columna [,RESTRICCIONES];
		```
		- <font style="color:green">Ejemplo</font>:
		```SQL
		 ALTER TABLE pedidos
		 ADD COLUMN producto VARCHAR(50) NOT NULL;
		```
- <font style="color:#08F; font-weight:bold">Cambiar nombre columna</font>:
	- <font style="color:orange; font-weight:bold">Sintaxis</font>:
		```SQL
		 ALTER TABLE nombre_tabla
			 CHANGE nombre_col nueva_nombre_col TIPO_COLUMNA [,RESTRICCIONES];
		```
		- <font style="color:green">Ejemplo</font>:
		```SQL
		 ALTER TABLE clientes
		 CHANGE dir_cp codigo_postal VARCHAR(5) NOT NULL;
		```
# Registros (filas)
[[07. Registros (filas)]]
<font style="color:#08F; font-weight:bold">Ver registros de una tabla</font>:
- <font style="color:orange; font-weight:bold">Sintaxis</font>:
	```SQL
	SELECT * FROM nombre_tabla;
	```
<font style="color:#08F; font-weight:bold">Insertar registros</font>:
- <font style="color:orange; font-weight:bold">Sintaxis</font> (para un registro):
```SQL
	INSERT INTO nombre_tabla (columna1, columna2)
	VALUES('registro1', 'registro2');
```
<font style="color:orange; font-weight:bold">Sintaxis</font> (para varios registros):
```SQL
	INSERT INTO nombre_tabla (columna1, columna2)
	VALUES('registro1', 'registro2'),
	('registro1', 'registro2);
```
- <font style="color:green">Ejemplo</font>:
	```SQL
	INSERT INTO clientes (nombre, codigo_postal)
	VALUES('Martínez e hijos', 03104),
	('Copisteria Pérez', 02104);
	```
	